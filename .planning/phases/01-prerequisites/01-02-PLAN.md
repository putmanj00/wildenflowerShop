---
phase: 01-prerequisites
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - constants/theme.ts
  - app/(tabs)/_layout.tsx
autonomous: true
requirements:
  - PLAT-01

must_haves:
  truths:
    - "No shadow deprecation warnings appear in the browser console when running npx expo start --web"
    - "Shadows render visibly on web — ProductCard, HeroCard, and PrimaryButton have visible box shadows"
    - "Tab bar has a visible upward shadow on web (no clipping between content and tab bar)"
    - "Native shadow behavior is unchanged — existing shadowColor/elevation props still apply on iOS/Android"
  artifacts:
    - path: "constants/theme.ts"
      provides: "Shadow tokens with Platform.select web fallbacks"
      contains: "Platform.select"
    - path: "app/(tabs)/_layout.tsx"
      provides: "Tab bar inline shadow with web boxShadow fallback"
      contains: "boxShadow"
  key_links:
    - from: "constants/theme.ts"
      to: "components/ProductCard.tsx"
      via: "spread operator: ...shadows.md"
      pattern: "shadows\\.md|shadows\\.lg|shadows\\.sm|shadows\\.glow"
    - from: "app/(tabs)/_layout.tsx"
      to: "tabBarStyle"
      via: "Platform.select with boxShadow for web"
      pattern: "Platform\\.select.*boxShadow|boxShadow.*Platform\\.select"
---

<objective>
Add cross-platform web shadow fallbacks to eliminate react-native-web deprecation warnings.

Purpose: react-native-web 0.19+ deprecates `shadowColor`, `shadowOpacity`, `shadowRadius`, and `shadowOffset` props in favor of a CSS `boxShadow` string. The current `shadows` tokens in `constants/theme.ts` use only native shadow props — spreading them on web generates deprecation warnings for every render of ProductCard, HeroCard, and PrimaryButton. Shadows also do not visibly render on web without `boxShadow`. The tab bar also has an inline upward shadow with the same issue.

Output: Updated `constants/theme.ts` with `Platform.select` shadow tokens (web gets `boxShadow` CSS string, native keeps existing props), and updated `app/(tabs)/_layout.tsx` with the same treatment for the inline tab bar shadow.
</objective>

<execution_context>
@/Users/jamesputman/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jamesputman/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/01-prerequisites/01-RESEARCH.md
@constants/theme.ts
@app/(tabs)/_layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Platform.select web fallbacks to shadow tokens in theme.ts</name>
  <files>constants/theme.ts</files>
  <action>
Update the `shadows` object in `constants/theme.ts` to use `Platform.select` for each variant.

First, add the Platform import at the top of the file (after existing imports, before the colors export):
```typescript
import { Platform } from 'react-native';
```

Then replace the entire `shadows` export with the following (preserving the comment block above it):

```typescript
export const shadows = {
  sm: {
    ...Platform.select({
      web: {
        boxShadow: '0px 2px 4px rgba(59, 47, 47, 0.08)',
      },
      default: {
        shadowColor: colors.earth,
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: 0.08,
        shadowRadius: 4,
        elevation: 2,
      },
    }),
  },
  md: {
    ...Platform.select({
      web: {
        boxShadow: '0px 4px 8px rgba(59, 47, 47, 0.10)',
      },
      default: {
        shadowColor: colors.earth,
        shadowOffset: { width: 0, height: 4 },
        shadowOpacity: 0.1,
        shadowRadius: 8,
        elevation: 4,
      },
    }),
  },
  lg: {
    ...Platform.select({
      web: {
        boxShadow: '0px 8px 16px rgba(59, 47, 47, 0.12)',
      },
      default: {
        shadowColor: colors.earth,
        shadowOffset: { width: 0, height: 8 },
        shadowOpacity: 0.12,
        shadowRadius: 16,
        elevation: 8,
      },
    }),
  },
  glow: {
    ...Platform.select({
      web: {
        boxShadow: '0px 4px 12px rgba(201, 166, 66, 0.20)',
      },
      default: {
        shadowColor: colors.gold,
        shadowOffset: { width: 0, height: 4 },
        shadowOpacity: 0.2,
        shadowRadius: 12,
        elevation: 6,
      },
    }),
  },
};
```

Color reference (for transparency): `colors.earth` = `#3B2F2F` = `rgb(59, 47, 47)`, `colors.gold` = `#C9A642` = `rgb(201, 166, 66)`. These are already encoded in the rgba strings above — do not change them.

The `cssBoxShadow` string format: `'offsetX offsetY blurRadius color'` where the color uses rgba with the opacity already baked in (since CSS boxShadow doesn't have a separate opacity property).

Components that spread these tokens (`...shadows.md`, `...shadows.lg`, `...shadows.sm`, `...shadows.glow`) require no changes — the spread still works because `Platform.select` resolves to a flat object at runtime.

Do NOT use React Native 0.76's native `boxShadow` prop directly — there are known Expo SDK 52 issues with it in dev builds. Use `Platform.select` with the CSS string in the `web` key only.
  </action>
  <verify>
`npx tsc --noEmit` passes.
Inspect `constants/theme.ts`: confirms `import { Platform } from 'react-native'` is present at the top, and each shadow variant (`sm`, `md`, `lg`, `glow`) uses `Platform.select` with a `web` key containing a `boxShadow` string and a `default` key containing native shadow props.
  </verify>
  <done>
`constants/theme.ts` exports `shadows` with `Platform.select` applied to all four variants. Each variant has `boxShadow` CSS string for web and existing native props for default (iOS/Android).
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix inline tab bar shadow in tabs layout</name>
  <files>app/(tabs)/_layout.tsx</files>
  <action>
Update the inline tab bar shadow in `app/(tabs)/_layout.tsx` to use `Platform.select` with a CSS `boxShadow` fallback.

The tab bar uses an upward shadow (negative Y direction). The current `tabBarStyle` object has these shadow props inline:
```typescript
shadowColor: colors.earth,
shadowOffset: { width: 0, height: -2 },
shadowOpacity: 0.08,
shadowRadius: 8,
elevation: 8,
```

Replace these five lines with a spread of `Platform.select`:
```typescript
...Platform.select({
  web: {
    boxShadow: '0px -2px 8px rgba(59, 47, 47, 0.08)',
  },
  default: {
    shadowColor: colors.earth,
    shadowOffset: { width: 0, height: -2 },
    shadowOpacity: 0.08,
    shadowRadius: 8,
    elevation: 8,
  },
}),
```

Add `Platform` to the imports from `react-native` at the top of the file. The file already imports from `react-native` if it does, otherwise add: `import { Platform } from 'react-native';`

The tab bar shadow is intentionally upward (negative Y offset) to create a separation between content and the bottom nav. The CSS `boxShadow` uses `-2px` Y offset to match. This is a navigation prop object (`tabBarStyle`), not a StyleSheet — `Platform.select` with spread works correctly in both contexts.

Do NOT change any other part of `_layout.tsx`. Only replace the five native shadow props with the `Platform.select` spread.
  </action>
  <verify>
`npx tsc --noEmit` passes.
Inspect `app/(tabs)/_layout.tsx` `tabBarStyle` object: confirms `Platform.select` spread is present with `web: { boxShadow: '0px -2px 8px rgba(59, 47, 47, 0.08)' }` and native shadow props in `default` key.
  </verify>
  <done>
`app/(tabs)/_layout.tsx` tab bar shadow uses `Platform.select` — web gets CSS `boxShadow`, native keeps existing shadow props. No other changes to the file.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` — no new TypeScript errors.
2. Inspect `constants/theme.ts`: all four shadow variants (`sm`, `md`, `lg`, `glow`) contain `Platform.select` with `web: { boxShadow: ... }`.
3. Inspect `app/(tabs)/_layout.tsx`: `tabBarStyle` contains `...Platform.select({ web: { boxShadow: ... } })` spread.
4. Grep for raw `shadowColor` in theme.ts `shadows` export — should only appear inside `default:` keys of Platform.select, not at the top level.
</verification>

<success_criteria>
- `constants/theme.ts` shadow tokens use Platform.select — web key has CSS boxShadow string, default key has native shadow props
- `app/(tabs)/_layout.tsx` inline tab bar shadow uses Platform.select with CSS boxShadow for web
- No TypeScript errors introduced
- PLAT-01 requirement partially addressed: shadow deprecation warnings eliminated on web; shadows render visibly
</success_criteria>

<output>
After completion, create `.planning/phases/01-prerequisites/01-02-SUMMARY.md`
</output>
