---
phase: 10
plan: 4
wave: 2
---

# Plan 10.4: Menu Integration & Order History

## Objective
Update the existing Menu screen to reflect the user's authentication state and create an Order History screen to query past orders.

## Context
- .planning/REQUIREMENTS.md
- app/(tabs)/menu.tsx
- context/AuthContext.tsx
- lib/shopify-queries.ts

## Tasks

<task type="auto">
  <name>Update Menu Screen</name>
  <files>app/(tabs)/menu.tsx</files>
  <action>
    - Use `useAuth()` to check if a customer is logged in.
    - If unauthenticated, the "Sign In / Register" link routes to `/(auth)/login`.
    - If authenticated, display a "Sign Out" button calling `logout()`.
    - Ensure styling matches the current MenuScreen layout and organic dividers.
  </action>
  <verify>grep "useAuth" app/(tabs)/menu.tsx</verify>
  <done>Menu screen conditionally surfaces Sign In or Sign Out depending on authentication state.</done>
</task>

<task type="auto">
  <name>Implement Order History Screen</name>
  <files>app/(auth)/orders.tsx</files>
  <action>
    - Create an Orders screen that queries `customer { orders }` from Shopify.
    - Display previous purchases in structured cards using brand themes.
    - If the user has no orders, display an empty state (`empty-state-botanical.png` concept) matching the Cart empty state.
    - Update the "Order History" link in `menu.tsx` to push to this new screen when logged in.
  </action>
  <verify>ls app/(auth)/orders.tsx</verify>
  <done>Authenticated users can view a list of historical orders on a dedicated screen.</done>
</task>

## Success Criteria
- [ ] Menu tab reflects accurate auth state (Sign In vs Sign Out).
- [ ] Viewing order history successfully queries Shopify through the storefront API and renders past purchases.
